<html>

<head>
    <title>ToolDAQ | Add Run Configuration</title>
</head>

<body>
    <!--#include virtual="/includes/header.html" -->
    <!--#include virtual="subheader.html" -->
    <!--#include virtual="/includes/drawer.html" -->

    <h1 align="center">Add New Configuration</h1>
    <form id="configForm" method="POST">
        <label for="name">Configuration Name:</label><br>
        <input type="text" id="name" name="name" size="40" style="margin:10px;" required><br><br>

        <label for="description">Description:</label><br>
        <textarea id="description" name="description" rows="3" cols="100" style="resize:both; width:80%; margin:10px;" required></textarea><br><br>

        <label for="author">Author:</label><br>
        <input type="text" id="author" name="author" size="40" style="margin:10px;" required><br><br>

        <label for="data">Configuration Data (JSON):</label><br>
        <textarea id="data" name="data" rows="4" cols="100" style="resize:both; width:80%; margin:10px;" required></textarea><br><br>
        
        <script type="text/javascript">
            const datainput = document.querySelector("#data");
            datainput.addEventListener('input', autoResize, false);
            
            const descriptinput = document.querySelector("#description");
            descriptinput.addEventListener('input', autoResize, false);
            
            function autoResize() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            }
        </script>

        <button type="button" id="addConfigBtn"">Add Configuration</button>
    </form>

    <!-- Modal for selecting device configurations -->
    <dialog id="deviceConfigModal" class="mdl-dialog">
        <h4>Select Device Configurations</h4>
        <div id="deviceConfigList">
            <!-- Device config list will be dynamically populated here -->
        </div>
        <br>
        <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect"
            onclick="closeModal()">
            Close
        </button>
        <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect"
            onclick="addSelectedConfigs()">
            Add Selected
        </button>
    </dialog>

    <h1 align="center">Existing Configurations</h1>
    <p> </p>
    <div id="configTable" style="padding: 20px"> </div>
</body>
<!--#include virtual="/includes/footer.html" -->

</html>
<script type="module" src="/includes/functions.js?v=1" async></script>
<script type="module" src="./configurations.js?v=1" async></script>
